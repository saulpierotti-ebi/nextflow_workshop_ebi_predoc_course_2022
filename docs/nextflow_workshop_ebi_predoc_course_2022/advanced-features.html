<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Advanced features | Nextflow workshop - EBI predoc course 2022</title>
  <meta name="description" content="4 Advanced features | Nextflow workshop - EBI predoc course 2022" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Advanced features | Nextflow workshop - EBI predoc course 2022" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="saulpierotti-ebi/saulpierotti-ebi.github.io" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Advanced features | Nextflow workshop - EBI predoc course 2022" />
  
  
  

<meta name="author" content="Saul Pierotti, PhD student in the Birney group (European Bioinformatics Institute)" />


<meta name="date" content="2022-10-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="basic-challenge.html"/>
<link rel="next" href="advanced-challenge.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link rel="icon" href="images/favicon.ico">


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  { color: #cccccc; background-color: #303030; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ffcfaf; } /* Alert */
code span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #dca3a3; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #f0dfaf; } /* ControlFlow */
code span.ch { color: #dca3a3; } /* Char */
code span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
code span.co { color: #7f9f7f; } /* Comment */
code span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
code span.do { color: #7f9f7f; } /* Documentation */
code span.dt { color: #dfdfbf; } /* DataType */
code span.dv { color: #dcdccc; } /* DecVal */
code span.er { color: #c3bf9f; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #c0bed1; } /* Float */
code span.fu { color: #efef8f; } /* Function */
code span.im { } /* Import */
code span.in { color: #7f9f7f; font-weight: bold; } /* Information */
code span.kw { color: #f0dfaf; } /* Keyword */
code span.op { color: #f0efd0; } /* Operator */
code span.ot { color: #efef8f; } /* Other */
code span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
code span.sc { color: #dca3a3; } /* SpecialChar */
code span.ss { color: #cc9393; } /* SpecialString */
code span.st { color: #cc9393; } /* String */
code span.va { } /* Variable */
code span.vs { color: #cc9393; } /* VerbatimString */
code span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#prerequisites"><i class="fa fa-check"></i><b>1.1</b> Prerequisites</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#what-is-nextflow"><i class="fa fa-check"></i><b>1.2</b> What is Nextflow?</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#learning-objectives"><i class="fa fa-check"></i><b>1.3</b> Learning objectives</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#setup"><i class="fa fa-check"></i><b>1.4</b> Setup</a></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#getting-started"><i class="fa fa-check"></i><b>1.5</b> Getting started</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="introduction.html"><a href="introduction.html#general-anatomy-of-a-nextflow-workflow"><i class="fa fa-check"></i><b>1.5.1</b> General anatomy of a Nextflow workflow</a></li>
<li class="chapter" data-level="1.5.2" data-path="introduction.html"><a href="introduction.html#nextflow-domain-specific-language-versions"><i class="fa fa-check"></i><b>1.5.2</b> Nextflow domain-specific language versions</a></li>
<li class="chapter" data-level="1.5.3" data-path="introduction.html"><a href="introduction.html#core-concepts"><i class="fa fa-check"></i><b>1.5.3</b> Core concepts</a></li>
<li class="chapter" data-level="1.5.4" data-path="introduction.html"><a href="introduction.html#your-first-workflow"><i class="fa fa-check"></i><b>1.5.4</b> Your first workflow</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="basic-features.html"><a href="basic-features.html"><i class="fa fa-check"></i><b>2</b> Basic features</a>
<ul>
<li class="chapter" data-level="2.1" data-path="basic-features.html"><a href="basic-features.html#multiple-processes-and-publication-of-workflow-outputs"><i class="fa fa-check"></i><b>2.1</b> Multiple processes and publication of workflow outputs</a></li>
<li class="chapter" data-level="2.2" data-path="basic-features.html"><a href="basic-features.html#creating-channels-and-specifying-pipeline-parameters"><i class="fa fa-check"></i><b>2.2</b> Creating channels and specifying pipeline parameters</a></li>
<li class="chapter" data-level="2.3" data-path="basic-features.html"><a href="basic-features.html#multiple-input-files"><i class="fa fa-check"></i><b>2.3</b> Multiple input files</a></li>
<li class="chapter" data-level="2.4" data-path="basic-features.html"><a href="basic-features.html#using-a-sample-sheet-and-value-channels"><i class="fa fa-check"></i><b>2.4</b> Using a sample sheet and value channels</a></li>
<li class="chapter" data-level="2.5" data-path="basic-features.html"><a href="basic-features.html#the-tuple-input-qualifier-and-joining-channels"><i class="fa fa-check"></i><b>2.5</b> The <code>tuple</code> input qualifier and joining channels</a></li>
<li class="chapter" data-level="2.6" data-path="basic-features.html"><a href="basic-features.html#software-dependencies"><i class="fa fa-check"></i><b>2.6</b> Software dependencies</a></li>
<li class="chapter" data-level="2.7" data-path="basic-features.html"><a href="basic-features.html#resource-allocation"><i class="fa fa-check"></i><b>2.7</b> Resource allocation</a></li>
<li class="chapter" data-level="2.8" data-path="basic-features.html"><a href="basic-features.html#the-resume-feature"><i class="fa fa-check"></i><b>2.8</b> The resume feature</a></li>
<li class="chapter" data-level="2.9" data-path="basic-features.html"><a href="basic-features.html#nf-core-pipelines"><i class="fa fa-check"></i><b>2.9</b> nf-core pipelines</a></li>
<li class="chapter" data-level="2.10" data-path="basic-features.html"><a href="basic-features.html#labels"><i class="fa fa-check"></i><b>2.10</b> Labels</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="basic-challenge.html"><a href="basic-challenge.html"><i class="fa fa-check"></i><b>3</b> Basic challenge</a></li>
<li class="chapter" data-level="4" data-path="advanced-features.html"><a href="advanced-features.html"><i class="fa fa-check"></i><b>4</b> Advanced features</a>
<ul>
<li class="chapter" data-level="4.1" data-path="advanced-features.html"><a href="advanced-features.html#process-inputs"><i class="fa fa-check"></i><b>4.1</b> Process inputs</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="advanced-features.html"><a href="advanced-features.html#input-of-type-val"><i class="fa fa-check"></i><b>4.1.1</b> Input of type <code>val</code></a></li>
<li class="chapter" data-level="4.1.2" data-path="advanced-features.html"><a href="advanced-features.html#input-of-type-path"><i class="fa fa-check"></i><b>4.1.2</b> Input of type <code>path</code></a></li>
<li class="chapter" data-level="4.1.3" data-path="advanced-features.html"><a href="advanced-features.html#input-of-type-tuple"><i class="fa fa-check"></i><b>4.1.3</b> Input of type <code>tuple</code></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="advanced-features.html"><a href="advanced-features.html#process-outputs"><i class="fa fa-check"></i><b>4.2</b> Process outputs</a></li>
<li class="chapter" data-level="4.3" data-path="advanced-features.html"><a href="advanced-features.html#the-groovy-programming-language"><i class="fa fa-check"></i><b>4.3</b> The Groovy programming language</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="advanced-features.html"><a href="advanced-features.html#closures"><i class="fa fa-check"></i><b>4.3.1</b> Closures</a></li>
<li class="chapter" data-level="4.3.2" data-path="advanced-features.html"><a href="advanced-features.html#conditional-statements"><i class="fa fa-check"></i><b>4.3.2</b> Conditional statements</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="advanced-features.html"><a href="advanced-features.html#channel-factories"><i class="fa fa-check"></i><b>4.4</b> Channel factories</a></li>
<li class="chapter" data-level="4.5" data-path="advanced-features.html"><a href="advanced-features.html#operators"><i class="fa fa-check"></i><b>4.5</b> Operators</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="advanced-features.html"><a href="advanced-features.html#the-view-operator"><i class="fa fa-check"></i><b>4.5.1</b> The <code>view</code> operator</a></li>
<li class="chapter" data-level="4.5.2" data-path="advanced-features.html"><a href="advanced-features.html#the-map-operator"><i class="fa fa-check"></i><b>4.5.2</b> The <code>map</code> operator</a></li>
<li class="chapter" data-level="4.5.3" data-path="advanced-features.html"><a href="advanced-features.html#the-set-operator"><i class="fa fa-check"></i><b>4.5.3</b> The <code>set</code> operator</a></li>
<li class="chapter" data-level="4.5.4" data-path="advanced-features.html"><a href="advanced-features.html#the-splitcsv-operator"><i class="fa fa-check"></i><b>4.5.4</b> The <code>splitCsv</code> operator</a></li>
<li class="chapter" data-level="4.5.5" data-path="advanced-features.html"><a href="advanced-features.html#the-flatten-operator"><i class="fa fa-check"></i><b>4.5.5</b> The <code>flatten</code> operator</a></li>
<li class="chapter" data-level="4.5.6" data-path="advanced-features.html"><a href="advanced-features.html#the-collect-operator"><i class="fa fa-check"></i><b>4.5.6</b> The <code>collect</code> operator</a></li>
<li class="chapter" data-level="4.5.7" data-path="advanced-features.html"><a href="advanced-features.html#the-filter-operator"><i class="fa fa-check"></i><b>4.5.7</b> The <code>filter</code> operator</a></li>
<li class="chapter" data-level="4.5.8" data-path="advanced-features.html"><a href="advanced-features.html#the-first-operator"><i class="fa fa-check"></i><b>4.5.8</b> The <code>first</code> operator</a></li>
<li class="chapter" data-level="4.5.9" data-path="advanced-features.html"><a href="advanced-features.html#the-combine-operator"><i class="fa fa-check"></i><b>4.5.9</b> The <code>combine</code> operator</a></li>
<li class="chapter" data-level="4.5.10" data-path="advanced-features.html"><a href="advanced-features.html#the-grouptuple-operator"><i class="fa fa-check"></i><b>4.5.10</b> The <code>groupTuple</code> operator</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="advanced-features.html"><a href="advanced-features.html#implicit-variables"><i class="fa fa-check"></i><b>4.6</b> Implicit variables</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="advanced-features.html"><a href="advanced-features.html#script-implicit-variables-available-in-main.nf"><i class="fa fa-check"></i><b>4.6.1</b> Script implicit variables (available in <code>main.nf</code>)</a></li>
<li class="chapter" data-level="4.6.2" data-path="advanced-features.html"><a href="advanced-features.html#configuration-implicit-variables-available-in-nextflow.config"><i class="fa fa-check"></i><b>4.6.2</b> Configuration implicit variables (available in <code>nextflow.config</code>)</a></li>
<li class="chapter" data-level="4.6.3" data-path="advanced-features.html"><a href="advanced-features.html#process-implicit-variables-defined-within-a-process"><i class="fa fa-check"></i><b>4.6.3</b> Process implicit variables (defined within a process)</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="advanced-features.html"><a href="advanced-features.html#directives"><i class="fa fa-check"></i><b>4.7</b> Directives</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="advanced-features.html"><a href="advanced-features.html#the-conda-directive"><i class="fa fa-check"></i><b>4.7.1</b> The <code>conda</code> directive</a></li>
<li class="chapter" data-level="4.7.2" data-path="advanced-features.html"><a href="advanced-features.html#the-container-directive"><i class="fa fa-check"></i><b>4.7.2</b> The <code>container</code> directive</a></li>
<li class="chapter" data-level="4.7.3" data-path="advanced-features.html"><a href="advanced-features.html#the-cpus-memory-and-time-directives"><i class="fa fa-check"></i><b>4.7.3</b> The <code>cpus</code>, <code>memory</code>, and <code>time</code> directives</a></li>
<li class="chapter" data-level="4.7.4" data-path="advanced-features.html"><a href="advanced-features.html#the-label-directive"><i class="fa fa-check"></i><b>4.7.4</b> The <code>label</code> directive</a></li>
<li class="chapter" data-level="4.7.5" data-path="advanced-features.html"><a href="advanced-features.html#the-debug-directive"><i class="fa fa-check"></i><b>4.7.5</b> The <code>debug</code> directive</a></li>
<li class="chapter" data-level="4.7.6" data-path="advanced-features.html"><a href="advanced-features.html#the-cache-directive"><i class="fa fa-check"></i><b>4.7.6</b> The <code>cache</code> directive</a></li>
<li class="chapter" data-level="4.7.7" data-path="advanced-features.html"><a href="advanced-features.html#the-errorstrategy-directive"><i class="fa fa-check"></i><b>4.7.7</b> The <code>errorStrategy</code> directive</a></li>
<li class="chapter" data-level="4.7.8" data-path="advanced-features.html"><a href="advanced-features.html#the-publishdir-directive"><i class="fa fa-check"></i><b>4.7.8</b> The <code>publishDir</code> directive</a></li>
<li class="chapter" data-level="4.7.9" data-path="advanced-features.html"><a href="advanced-features.html#the-executor-and-queue-directives"><i class="fa fa-check"></i><b>4.7.9</b> The <code>executor</code> and <code>queue</code> directives</a></li>
<li class="chapter" data-level="4.7.10" data-path="advanced-features.html"><a href="advanced-features.html#the-ext-directive"><i class="fa fa-check"></i><b>4.7.10</b> The <code>ext</code> directive</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="advanced-features.html"><a href="advanced-features.html#advanced-workflow-configuration"><i class="fa fa-check"></i><b>4.8</b> Advanced workflow configuration</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="advanced-features.html"><a href="advanced-features.html#configuration-files-and-command-line-parameters"><i class="fa fa-check"></i><b>4.8.1</b> Configuration files and command line parameters</a></li>
<li class="chapter" data-level="4.8.2" data-path="advanced-features.html"><a href="advanced-features.html#configuration-profiles"><i class="fa fa-check"></i><b>4.8.2</b> Configuration profiles</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="advanced-features.html"><a href="advanced-features.html#sub-workflows"><i class="fa fa-check"></i><b>4.9</b> Sub-workflows</a></li>
<li class="chapter" data-level="4.10" data-path="advanced-features.html"><a href="advanced-features.html#nextflow-tower"><i class="fa fa-check"></i><b>4.10</b> Nextflow Tower</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="advanced-challenge.html"><a href="advanced-challenge.html"><i class="fa fa-check"></i><b>5</b> Advanced challenge</a>
<ul>
<li class="chapter" data-level="5.1" data-path="advanced-challenge.html"><a href="advanced-challenge.html#setup-1"><i class="fa fa-check"></i><b>5.1</b> Setup</a></li>
<li class="chapter" data-level="5.2" data-path="advanced-challenge.html"><a href="advanced-challenge.html#solution"><i class="fa fa-check"></i><b>5.2</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i>Additional resources</a></li>
<li class="chapter" data-level="" data-path="credits.html"><a href="credits.html"><i class="fa fa-check"></i>Credits</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Nextflow workshop - EBI predoc course 2022</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="advanced-features" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> Advanced features<a href="advanced-features.html#advanced-features" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>If you are reading the advanced section of this workshop I am assuming that you are already familiar with what are workflows, processes, and operators.
I am also assuming that you know how a Nextflow workflow is structured and you understand the syntax and logic used in writing and configuring Nextflow pipelines.
For this reason, you will find the following section to be a bit different from the ones that came before.
I will not walk you through complete reproducible examples as I did until now, but I will present small snippets of code that show some specific functionality or practice that I deemed to be useful to know.
You are supposed to try out by yourself these ideas, and see how they can be applied to your own use case.</p>
<div id="process-inputs" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Process inputs<a href="advanced-features.html#process-inputs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The input(s) used by a process is defined in its <code>input:</code> block, as we saw before.
The input(s) specified can be of several types.
We already saw in the basic section of this workshop the <code>path</code> and <code>val</code> input qualifiers.
We will see them more in detail now, as well as explore some additional input qualifiers.</p>
<div id="input-of-type-val" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Input of type <code>val</code><a href="advanced-features.html#input-of-type-val" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>An input of type <code>val</code> just defines a value, that is made available to the process as a variable.</p>
<p>As an example, the following code writes the value “Good morning” to the file called <code>my_file.txt</code>.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb70-1"><a href="advanced-features.html#cb70-1" aria-hidden="true" tabindex="-1"></a>process say_hello <span class="op">{</span></span>
<span id="cb70-2"><a href="advanced-features.html#cb70-2" aria-hidden="true" tabindex="-1"></a>  input<span class="op">:</span></span>
<span id="cb70-3"><a href="advanced-features.html#cb70-3" aria-hidden="true" tabindex="-1"></a>    val greeting_sentence</span>
<span id="cb70-4"><a href="advanced-features.html#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="advanced-features.html#cb70-5" aria-hidden="true" tabindex="-1"></a>  output<span class="op">:</span></span>
<span id="cb70-6"><a href="advanced-features.html#cb70-6" aria-hidden="true" tabindex="-1"></a>    path <span class="st">&quot;my_file.txt&quot;</span></span>
<span id="cb70-7"><a href="advanced-features.html#cb70-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-8"><a href="advanced-features.html#cb70-8" aria-hidden="true" tabindex="-1"></a>  script<span class="op">:</span></span>
<span id="cb70-9"><a href="advanced-features.html#cb70-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb70-10"><a href="advanced-features.html#cb70-10" aria-hidden="true" tabindex="-1"></a><span class="st">    echo </span><span class="ss">$greeting_sentence</span><span class="st"> &gt; my_file.txt</span></span>
<span id="cb70-11"><a href="advanced-features.html#cb70-11" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;&quot;&quot;</span></span>
<span id="cb70-12"><a href="advanced-features.html#cb70-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb70-13"><a href="advanced-features.html#cb70-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-14"><a href="advanced-features.html#cb70-14" aria-hidden="true" tabindex="-1"></a>workflow <span class="op">{</span></span>
<span id="cb70-15"><a href="advanced-features.html#cb70-15" aria-hidden="true" tabindex="-1"></a>  <span class="bu">Channel</span><span class="op">.</span><span class="fu">value</span><span class="op">(</span><span class="st">&quot;Good morning&quot;</span><span class="op">).</span><span class="fu">set</span><span class="op">{</span> my_ch <span class="op">}</span></span>
<span id="cb70-16"><a href="advanced-features.html#cb70-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">say_hello</span><span class="op">(</span> my_ch <span class="op">)</span></span>
<span id="cb70-17"><a href="advanced-features.html#cb70-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<div id="input-of-type-path" class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Input of type <code>path</code><a href="advanced-features.html#input-of-type-path" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>An input of type <code>path</code> stages a file in the working directory of the process, and makes the filename available to the process under the variable declared.</p>
<p>As an example, the following code just reads the file <code>/path/to/a/file.txt</code> to the standard output.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb71-1"><a href="advanced-features.html#cb71-1" aria-hidden="true" tabindex="-1"></a>process read_file <span class="op">{</span></span>
<span id="cb71-2"><a href="advanced-features.html#cb71-2" aria-hidden="true" tabindex="-1"></a>  input<span class="op">:</span></span>
<span id="cb71-3"><a href="advanced-features.html#cb71-3" aria-hidden="true" tabindex="-1"></a>    path my_file</span>
<span id="cb71-4"><a href="advanced-features.html#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="advanced-features.html#cb71-5" aria-hidden="true" tabindex="-1"></a>  script<span class="op">:</span></span>
<span id="cb71-6"><a href="advanced-features.html#cb71-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb71-7"><a href="advanced-features.html#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="st">    cat </span><span class="ss">$my_file</span></span>
<span id="cb71-8"><a href="advanced-features.html#cb71-8" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;&quot;&quot;</span></span>
<span id="cb71-9"><a href="advanced-features.html#cb71-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb71-10"><a href="advanced-features.html#cb71-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-11"><a href="advanced-features.html#cb71-11" aria-hidden="true" tabindex="-1"></a>workflow <span class="op">{</span></span>
<span id="cb71-12"><a href="advanced-features.html#cb71-12" aria-hidden="true" tabindex="-1"></a>  <span class="bu">Channel</span><span class="op">.</span><span class="fu">fromPath</span><span class="op">(</span><span class="st">&quot;/path/to/a/file.txt&quot;</span><span class="op">).</span><span class="fu">set</span><span class="op">{</span> my_ch <span class="op">}</span></span>
<span id="cb71-13"><a href="advanced-features.html#cb71-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_file</span><span class="op">(</span> my_ch <span class="op">)</span></span>
<span id="cb71-14"><a href="advanced-features.html#cb71-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<div id="input-of-type-tuple" class="section level3 hasAnchor" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Input of type <code>tuple</code><a href="advanced-features.html#input-of-type-tuple" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>An input of type <code>tuple</code> can be used when the channel given in input to the process emits lists of elements instead of single elements.
The elements contained in the list can be of any type, like for example <code>val</code> or <code>path</code>.</p>
<p>As an example, the following code appends the value “Good morning” to the file <code>/path/to/a/file.txt</code>.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb72-1"><a href="advanced-features.html#cb72-1" aria-hidden="true" tabindex="-1"></a>process append_value_to_file <span class="op">{</span></span>
<span id="cb72-2"><a href="advanced-features.html#cb72-2" aria-hidden="true" tabindex="-1"></a>  input<span class="op">:</span></span>
<span id="cb72-3"><a href="advanced-features.html#cb72-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tuple</span><span class="op">(</span></span>
<span id="cb72-4"><a href="advanced-features.html#cb72-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">path</span><span class="op">(</span>my_file<span class="op">),</span></span>
<span id="cb72-5"><a href="advanced-features.html#cb72-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">val</span><span class="op">(</span>my_value<span class="op">)</span></span>
<span id="cb72-6"><a href="advanced-features.html#cb72-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">)</span></span>
<span id="cb72-7"><a href="advanced-features.html#cb72-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-8"><a href="advanced-features.html#cb72-8" aria-hidden="true" tabindex="-1"></a>  script<span class="op">:</span></span>
<span id="cb72-9"><a href="advanced-features.html#cb72-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb72-10"><a href="advanced-features.html#cb72-10" aria-hidden="true" tabindex="-1"></a><span class="st">    echo </span><span class="ss">$my_value</span><span class="st"> &gt;&gt; </span><span class="ss">$my_file</span></span>
<span id="cb72-11"><a href="advanced-features.html#cb72-11" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;&quot;&quot;</span></span>
<span id="cb72-12"><a href="advanced-features.html#cb72-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb72-13"><a href="advanced-features.html#cb72-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-14"><a href="advanced-features.html#cb72-14" aria-hidden="true" tabindex="-1"></a>workflow <span class="op">{</span></span>
<span id="cb72-15"><a href="advanced-features.html#cb72-15" aria-hidden="true" tabindex="-1"></a>  <span class="bu">Channel</span><span class="op">.</span><span class="fu">of</span><span class="op">(</span> <span class="op">[</span> <span class="st">&quot;Good morning&quot;</span><span class="op">,</span> <span class="st">&quot;/path/to/a/file.txt&quot;</span> <span class="op">]</span> <span class="op">).</span><span class="fu">set</span><span class="op">{</span> my_ch <span class="op">}</span></span>
<span id="cb72-16"><a href="advanced-features.html#cb72-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">append_value_to_file</span><span class="op">(</span> my_ch <span class="op">)</span></span>
<span id="cb72-17"><a href="advanced-features.html#cb72-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div id="process-outputs" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Process outputs<a href="advanced-features.html#process-outputs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Process outputs can have similar types to the ones used for process inputs.
So for example the output of a process can be a <code>path</code> variable (a file), a <code>val</code> variable (a groovy variable), or a <code>tuple</code> of such elements.
Other output types exist in Nextflow, but we will not treat them here.</p>
<p>Read <a href="https://www.nextflow.io/docs/latest/process.html#outputs">here</a> for more details.</p>
<p>See the following example:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb73-1"><a href="advanced-features.html#cb73-1" aria-hidden="true" tabindex="-1"></a>process append_value_to_file <span class="op">{</span></span>
<span id="cb73-2"><a href="advanced-features.html#cb73-2" aria-hidden="true" tabindex="-1"></a>  input<span class="op">:</span></span>
<span id="cb73-3"><a href="advanced-features.html#cb73-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tuple</span><span class="op">(</span></span>
<span id="cb73-4"><a href="advanced-features.html#cb73-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">path</span><span class="op">(</span>my_file<span class="op">),</span></span>
<span id="cb73-5"><a href="advanced-features.html#cb73-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">val</span><span class="op">(</span>my_value<span class="op">)</span></span>
<span id="cb73-6"><a href="advanced-features.html#cb73-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">)</span></span>
<span id="cb73-7"><a href="advanced-features.html#cb73-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-8"><a href="advanced-features.html#cb73-8" aria-hidden="true" tabindex="-1"></a>  output<span class="op">:</span></span>
<span id="cb73-9"><a href="advanced-features.html#cb73-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tuple</span><span class="op">(</span></span>
<span id="cb73-10"><a href="advanced-features.html#cb73-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">path</span><span class="op">(</span>my_file<span class="op">),</span></span>
<span id="cb73-11"><a href="advanced-features.html#cb73-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">val</span><span class="op">(</span>my_value<span class="op">)</span></span>
<span id="cb73-12"><a href="advanced-features.html#cb73-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">)</span></span>
<span id="cb73-13"><a href="advanced-features.html#cb73-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-14"><a href="advanced-features.html#cb73-14" aria-hidden="true" tabindex="-1"></a>  script<span class="op">:</span></span>
<span id="cb73-15"><a href="advanced-features.html#cb73-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb73-16"><a href="advanced-features.html#cb73-16" aria-hidden="true" tabindex="-1"></a><span class="st">    echo </span><span class="ss">$my_value</span><span class="st"> &gt;&gt; </span><span class="ss">$my_file</span></span>
<span id="cb73-17"><a href="advanced-features.html#cb73-17" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;&quot;&quot;</span></span>
<span id="cb73-18"><a href="advanced-features.html#cb73-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb73-19"><a href="advanced-features.html#cb73-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-20"><a href="advanced-features.html#cb73-20" aria-hidden="true" tabindex="-1"></a>workflow <span class="op">{</span></span>
<span id="cb73-21"><a href="advanced-features.html#cb73-21" aria-hidden="true" tabindex="-1"></a>  <span class="bu">Channel</span><span class="op">.</span><span class="fu">of</span><span class="op">(</span> <span class="op">[</span> <span class="st">&quot;Good morning&quot;</span><span class="op">,</span> <span class="st">&quot;/path/to/a/file.txt&quot;</span> <span class="op">]</span> <span class="op">).</span><span class="fu">set</span><span class="op">{</span> my_ch <span class="op">}</span></span>
<span id="cb73-22"><a href="advanced-features.html#cb73-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">append_value_to_file</span><span class="op">(</span> my_ch <span class="op">)</span></span>
<span id="cb73-23"><a href="advanced-features.html#cb73-23" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>In this example, we see the same process as before, but this time we declared an output block.
The output is of type <code>tuple</code>, with two elements contained in it (one of type <code>path</code> and the other of type <code>val</code>).
After execution of the process <code>append_value_to_file</code>, the channel <code>append_value_to_file.out</code> will contain a list of two elements.
The first element will be the filename given in input, and the second element will be the value given in input.
Note that the file produced in output by the process will not be the same file given in input to it: it will have been modified in the <code>script</code> block by appending <code>my_value</code> to it.</p>
</div>
<div id="the-groovy-programming-language" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> The Groovy programming language<a href="advanced-features.html#the-groovy-programming-language" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here we will talk about some features of the Groovy programming language, on which Nextflow is based, that can be useful when writing workflows.
If you want to test out some Groovy code interactively, head off to <a href="https://groovyconsole.appspot.com/">this website</a> and paste the code snippets that we will introduce.</p>
<div id="closures" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Closures<a href="advanced-features.html#closures" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We already introduced closures in previous sections, where we used them in conjunction with the map operator.
In general, we can consider a closure as an unnamed function, defined as a statement enclosed in curly brackets.
The following is a closure</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb74-1"><a href="advanced-features.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="op">{</span> it<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">}</span></span></code></pre></div>
<p>We can manually define the inputs and outputs of a closure.
For example:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb75-1"><a href="advanced-features.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb75-2"><a href="advanced-features.html#cb75-2" aria-hidden="true" tabindex="-1"></a>  x<span class="op">,</span> y <span class="op">-&gt;</span></span>
<span id="cb75-3"><a href="advanced-features.html#cb75-3" aria-hidden="true" tabindex="-1"></a>  z <span class="op">=</span> x <span class="op">+</span> y</span>
<span id="cb75-4"><a href="advanced-features.html#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> z</span>
<span id="cb75-5"><a href="advanced-features.html#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>In the above-defined example the closure expects two inputs, (<code>x,y -&gt;</code>), some operation is performed on them (<code>z = x + y</code>), and a value is explicitly returned (<code>return z</code>).
The definition of inputs is optional, and indeed it is usually skipped.
If an input is not defined, the implicit variable <code>it</code> is used to refer to any input passed to the closure.
So we could write the following, assuming that a tuple of two elements is passed as an input to the closure</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb76-1"><a href="advanced-features.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb76-2"><a href="advanced-features.html#cb76-2" aria-hidden="true" tabindex="-1"></a>  z <span class="op">=</span> it<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">+</span> it<span class="op">[</span><span class="dv">1</span><span class="op">]</span></span>
<span id="cb76-3"><a href="advanced-features.html#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> z</span>
<span id="cb76-4"><a href="advanced-features.html#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>What’s more, it is possible to also omit the <code>return</code> statement from a closure.
In this case, the last evaluated expression is returned.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb77-1"><a href="advanced-features.html#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="op">{</span> it<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">+</span> it<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">}</span></span></code></pre></div>
<p>As shown in the previous example, closures can be split into multiple lines or they can be written on a single line.
They can contain any valid Groovy code statement.
For example:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb78-1"><a href="advanced-features.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="op">{</span> <span class="cf">if</span> <span class="op">(</span> it <span class="op">&lt;</span> <span class="dv">1</span> <span class="op">)</span> <span class="op">{</span><span class="st">&quot;small&quot;</span><span class="op">}</span> <span class="cf">else</span> <span class="op">{</span> <span class="st">&quot;big&quot;</span> <span class="op">}</span> <span class="op">}</span></span></code></pre></div>
</div>
<div id="conditional-statements" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Conditional statements<a href="advanced-features.html#conditional-statements" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Conditional statements in Groovy can be written in several ways.
The simplest approach is that of a classic if/else statement.
This can be written, for example, as follows.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb79-1"><a href="advanced-features.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span> x <span class="op">&lt;</span> <span class="dv">1</span> <span class="op">)</span> <span class="op">{</span></span>
<span id="cb79-2"><a href="advanced-features.html#cb79-2" aria-hidden="true" tabindex="-1"></a>  y <span class="op">=</span> <span class="st">&quot;small&quot;</span></span>
<span id="cb79-3"><a href="advanced-features.html#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb79-4"><a href="advanced-features.html#cb79-4" aria-hidden="true" tabindex="-1"></a>  y <span class="op">=</span> <span class="st">&quot;big&quot;</span></span>
<span id="cb79-5"><a href="advanced-features.html#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>A more compact syntax to achieve the same result takes advantage of the ternary operator</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb80-1"><a href="advanced-features.html#cb80-1" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> <span class="op">(</span> x <span class="op">&lt;</span> <span class="dv">1</span> <span class="op">)</span> <span class="op">?</span> <span class="st">&quot;small&quot;</span> <span class="op">:</span> <span class="st">&quot;big&quot;</span></span></code></pre></div>
<p>In case when the return value desired for the <code>TRUE</code> case is the statement itself, the Elvis operator can be used</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb81-1"><a href="advanced-features.html#cb81-1" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> my_list <span class="op">?:</span> <span class="st">&quot;list is empty&quot;</span></span></code></pre></div>
<p>In the latter case, the variable <code>y</code> will contain the content of the list<code>my_list</code> if this is not empty, and it will contain the string <code>list is empty</code> otherwise.</p>
</div>
</div>
<div id="channel-factories" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Channel factories<a href="advanced-features.html#channel-factories" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Besides the <code>Channel.fromPath</code> and <code>Channel.value</code> channel factories that we saw before, another useful Channel factory (especially for debugging purposes) is <code>Channel.of</code>.
<code>Channel.of</code> allows you to put into a channel any Groovy data structure like lists, hash maps, and so on.
So takes as an example the following:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb82-1"><a href="advanced-features.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="bu">Channel</span><span class="op">.</span><span class="fu">of</span><span class="op">(</span></span>
<span id="cb82-2"><a href="advanced-features.html#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="op">[</span><span class="st">&quot;name&quot;</span><span class="op">:</span> <span class="st">&quot;EBI&quot;</span><span class="op">,</span> <span class="st">&quot;type&quot;</span><span class="op">:</span> <span class="st">&quot;institute&quot;</span><span class="op">,</span> <span class="st">&quot;location&quot;</span><span class="op">:</span> <span class="st">&quot;UK&quot;</span><span class="op">],</span></span>
<span id="cb82-3"><a href="advanced-features.html#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">[</span><span class="st">&quot;name&quot;</span><span class="op">:</span> <span class="st">&quot;GB&quot;</span><span class="op">,</span> <span class="st">&quot;type&quot;</span><span class="op">:</span> <span class="st">&quot;institute&quot;</span><span class="op">,</span> <span class="st">&quot;location&quot;</span><span class="op">:</span> <span class="st">&quot;Germany&quot;</span><span class="op">],</span></span>
<span id="cb82-4"><a href="advanced-features.html#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="op">)</span></span></code></pre></div>
<p>This will create a channel emitting two elements, each of them a Groovy map containing three elements.
What especially differentiates <code>Channel.of</code> from <code>Channel.value</code> is that the latter can contain only a single element.</p>
</div>
<div id="operators" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Operators<a href="advanced-features.html#operators" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the basic section of this workshop, we introduced a few Nextflow operators: <code>map</code>, <code>splitCsv</code>, <code>view</code>.
Here we will more formally describe such operators and also look at additional operators that can be helpful for workflows with more complex logic. Note that this is not an exhaustive list.
An exhaustive list can be found <a href="https://www.nextflow.io/docs/latest/operator.html#">here</a>.</p>
<div id="the-view-operator" class="section level3 hasAnchor" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> The <code>view</code> operator<a href="advanced-features.html#the-view-operator" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>view</code> operator just prints to the terminal the content of the channel, one element per line.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb83-1"><a href="advanced-features.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="bu">Channel</span><span class="op">.</span><span class="fu">of</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span><span class="dv">2</span><span class="op">,</span><span class="dv">3</span><span class="op">).</span><span class="fu">view</span><span class="op">()</span></span></code></pre></div>
<p>Expected output:</p>
<pre><code>1
2
3</code></pre>
</div>
<div id="the-map-operator" class="section level3 hasAnchor" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> The <code>map</code> operator<a href="advanced-features.html#the-map-operator" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>map</code> operator can be used to modify the content of a channel on the fly.
For example, it can be used to extract just some elements from a channel emitting lists.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb85-1"><a href="advanced-features.html#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="bu">Channel</span><span class="op">.</span><span class="fu">of</span><span class="op">(</span></span>
<span id="cb85-2"><a href="advanced-features.html#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="op">[</span><span class="st">&quot;name&quot;</span><span class="op">:</span> <span class="st">&quot;EBI&quot;</span><span class="op">,</span> <span class="st">&quot;type&quot;</span><span class="op">:</span> <span class="st">&quot;institute&quot;</span><span class="op">,</span> <span class="st">&quot;location&quot;</span><span class="op">:</span> <span class="st">&quot;UK&quot;</span><span class="op">],</span></span>
<span id="cb85-3"><a href="advanced-features.html#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">[</span><span class="st">&quot;name&quot;</span><span class="op">:</span> <span class="st">&quot;GB&quot;</span><span class="op">,</span> <span class="st">&quot;type&quot;</span><span class="op">:</span> <span class="st">&quot;institute&quot;</span><span class="op">,</span> <span class="st">&quot;location&quot;</span><span class="op">:</span> <span class="st">&quot;Germany&quot;</span><span class="op">],</span></span>
<span id="cb85-4"><a href="advanced-features.html#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="op">)</span></span>
<span id="cb85-5"><a href="advanced-features.html#cb85-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">map</span><span class="op">{</span> it<span class="op">[</span><span class="st">&quot;name&quot;</span><span class="op">]</span> <span class="op">}</span></span></code></pre></div>
<p>Expected output:</p>
<pre><code>EBI
GB</code></pre>
</div>
<div id="the-set-operator" class="section level3 hasAnchor" number="4.5.3">
<h3><span class="header-section-number">4.5.3</span> The <code>set</code> operator<a href="advanced-features.html#the-set-operator" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>set</code> operator assigns a name to a channel.
The name must be given as a closure argument.</p>
<pre><code>Channel.of(1, 2, 3).set{ my_ch }</code></pre>
<p>The above snippet creates a channel called <code>my_ch</code> with the values specified.</p>
</div>
<div id="the-splitcsv-operator" class="section level3 hasAnchor" number="4.5.4">
<h3><span class="header-section-number">4.5.4</span> The <code>splitCsv</code> operator<a href="advanced-features.html#the-splitcsv-operator" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>splitCsv</code> operator is usually used to process a sample sheet.
It takes a <code>path</code> channel containing a CSV file and emits each line of the CSV as a list of values (or as a hash map if <code>header: true</code> is specified).</p>
</div>
<div id="the-flatten-operator" class="section level3 hasAnchor" number="4.5.5">
<h3><span class="header-section-number">4.5.5</span> The <code>flatten</code> operator<a href="advanced-features.html#the-flatten-operator" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>flatten</code> operator will take all the elements in a channel and split them into single elements.
If the channel emits lists or nested lists, they are flattened and each element is emitted independently.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb88-1"><a href="advanced-features.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="bu">Channel</span><span class="op">.</span><span class="fu">of</span><span class="op">(</span></span>
<span id="cb88-2"><a href="advanced-features.html#cb88-2" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">],</span></span>
<span id="cb88-3"><a href="advanced-features.html#cb88-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span><span class="st">&quot;aa&quot;</span><span class="op">,</span> <span class="st">&quot;bb&quot;</span><span class="op">,</span> <span class="st">&quot;cc&quot;</span><span class="op">]</span></span>
<span id="cb88-4"><a href="advanced-features.html#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="op">)</span></span>
<span id="cb88-5"><a href="advanced-features.html#cb88-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">flatten</span><span class="op">()</span></span></code></pre></div>
<p>Expected output:</p>
<pre><code>1
2
3
aa
bb
cc</code></pre>
</div>
<div id="the-collect-operator" class="section level3 hasAnchor" number="4.5.6">
<h3><span class="header-section-number">4.5.6</span> The <code>collect</code> operator<a href="advanced-features.html#the-collect-operator" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>collect</code> operator is in a way performing the opposite operation of the <code>flatten</code> operator.
It takes all the elements in a channel and collects them in a single list, which is then emitted all at once.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb90-1"><a href="advanced-features.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="bu">Channel</span><span class="op">.</span><span class="fu">of</span><span class="op">(</span></span>
<span id="cb90-2"><a href="advanced-features.html#cb90-2" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">],</span></span>
<span id="cb90-3"><a href="advanced-features.html#cb90-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span><span class="st">&quot;aa&quot;</span><span class="op">,</span> <span class="st">&quot;bb&quot;</span><span class="op">,</span> <span class="st">&quot;cc&quot;</span><span class="op">]</span></span>
<span id="cb90-4"><a href="advanced-features.html#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="op">)</span></span>
<span id="cb90-5"><a href="advanced-features.html#cb90-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">collect</span><span class="op">()</span></span></code></pre></div>
<p>Expected output:</p>
<pre><code>[1, 2, 3, aa, bb, cc]</code></pre>
</div>
<div id="the-filter-operator" class="section level3 hasAnchor" number="4.5.7">
<h3><span class="header-section-number">4.5.7</span> The <code>filter</code> operator<a href="advanced-features.html#the-filter-operator" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>filter</code> operator filters the elements of a channel, emitting only the ones for which a condition is satisfied.
The condition is provided as a closure, with a boolean return value.
It is also possible to use a regular expression as a test, but we will not treat it here.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb92-1"><a href="advanced-features.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="bu">Channel</span><span class="op">.</span><span class="fu">of</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">5</span><span class="op">)</span></span>
<span id="cb92-2"><a href="advanced-features.html#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span><span class="op">{</span> it <span class="op">&gt;</span> <span class="dv">3</span> <span class="op">}</span></span></code></pre></div>
<p>Expected output:</p>
<pre><code>4
5</code></pre>
</div>
<div id="the-first-operator" class="section level3 hasAnchor" number="4.5.8">
<h3><span class="header-section-number">4.5.8</span> The <code>first</code> operator<a href="advanced-features.html#the-first-operator" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>first</code> operator just emits the first element of a channel.
Useful for testing the logic without running the full workflow.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb94-1"><a href="advanced-features.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="bu">Channel</span><span class="op">.</span><span class="fu">of</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">5</span><span class="op">).</span><span class="fu">first</span><span class="op">()</span></span></code></pre></div>
<p>Expected output:</p>
<pre><code>1</code></pre>
</div>
<div id="the-combine-operator" class="section level3 hasAnchor" number="4.5.9">
<h3><span class="header-section-number">4.5.9</span> The <code>combine</code> operator<a href="advanced-features.html#the-combine-operator" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The combine operator creates the Cartesian product of two channels (all the possible combinations of elements).</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb96-1"><a href="advanced-features.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="bu">Channel</span><span class="op">.</span><span class="fu">of</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span><span class="dv">2</span><span class="op">,</span><span class="dv">3</span><span class="op">).</span><span class="fu">set</span><span class="op">{</span> ch_1 <span class="op">}</span></span>
<span id="cb96-2"><a href="advanced-features.html#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="bu">Channel</span><span class="op">.</span><span class="fu">of</span><span class="op">(</span><span class="st">&quot;a&quot;</span><span class="op">,</span> <span class="st">&quot;b&quot;</span><span class="op">,</span> <span class="st">&quot;c&quot;</span><span class="op">).</span><span class="fu">set</span><span class="op">{</span> ch_2 <span class="op">}</span></span>
<span id="cb96-3"><a href="advanced-features.html#cb96-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-4"><a href="advanced-features.html#cb96-4" aria-hidden="true" tabindex="-1"></a>ch_1<span class="op">.</span><span class="fu">combine</span><span class="op">(</span>ch_2<span class="op">)</span></span></code></pre></div>
<p>Expected output:</p>
<pre><code>[1, a]
[2, a]
[1, b]
[2, b]
[3, a]
[3, b]
[1, c]
[2, c]
[3, c]</code></pre>
<p>The <code>combine</code> operator can also be used to join elements that present a matching key from two channels.
This is achieved by specifying the <code>by</code> argument, with an integer specifying the position in the tuple to use as a matching key.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb98-1"><a href="advanced-features.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="bu">Channel</span><span class="op">.</span><span class="fu">of</span><span class="op">(</span></span>
<span id="cb98-2"><a href="advanced-features.html#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="op">[</span><span class="st">&quot;key1&quot;</span><span class="op">,</span> <span class="dv">1</span><span class="op">],</span></span>
<span id="cb98-3"><a href="advanced-features.html#cb98-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">[</span><span class="st">&quot;key2&quot;</span><span class="op">,</span> <span class="dv">2</span><span class="op">],</span></span>
<span id="cb98-4"><a href="advanced-features.html#cb98-4" aria-hidden="true" tabindex="-1"></a>  <span class="op">[</span><span class="st">&quot;key3&quot;</span><span class="op">,</span> <span class="dv">3</span><span class="op">],</span></span>
<span id="cb98-5"><a href="advanced-features.html#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="op">).</span><span class="fu">set</span><span class="op">{</span> ch_1 <span class="op">}</span></span>
<span id="cb98-6"><a href="advanced-features.html#cb98-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-7"><a href="advanced-features.html#cb98-7" aria-hidden="true" tabindex="-1"></a><span class="bu">Channel</span><span class="op">.</span><span class="fu">of</span><span class="op">(</span></span>
<span id="cb98-8"><a href="advanced-features.html#cb98-8" aria-hidden="true" tabindex="-1"></a>  <span class="op">[</span><span class="st">&quot;key3&quot;</span><span class="op">,</span> <span class="st">&quot;aa&quot;</span><span class="op">],</span></span>
<span id="cb98-9"><a href="advanced-features.html#cb98-9" aria-hidden="true" tabindex="-1"></a>  <span class="op">[</span><span class="st">&quot;key1&quot;</span><span class="op">,</span> <span class="st">&quot;bb&quot;</span><span class="op">],</span></span>
<span id="cb98-10"><a href="advanced-features.html#cb98-10" aria-hidden="true" tabindex="-1"></a>  <span class="op">[</span><span class="st">&quot;key2&quot;</span><span class="op">,</span> <span class="st">&quot;cc&quot;</span><span class="op">],</span></span>
<span id="cb98-11"><a href="advanced-features.html#cb98-11" aria-hidden="true" tabindex="-1"></a><span class="op">).</span><span class="fu">set</span><span class="op">{</span> ch_2 <span class="op">}</span></span>
<span id="cb98-12"><a href="advanced-features.html#cb98-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-13"><a href="advanced-features.html#cb98-13" aria-hidden="true" tabindex="-1"></a>ch_1<span class="op">.</span><span class="fu">combine</span><span class="op">(</span>ch_2<span class="op">,</span> by<span class="op">:</span> <span class="dv">0</span><span class="op">)</span></span></code></pre></div>
<p>Expected output:</p>
<pre><code>[key1, 1, bb]
[key3, 3, aa]
[key2, 2, cc]</code></pre>
</div>
<div id="the-grouptuple-operator" class="section level3 hasAnchor" number="4.5.10">
<h3><span class="header-section-number">4.5.10</span> The <code>groupTuple</code> operator<a href="advanced-features.html#the-grouptuple-operator" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>groupTuple</code> operator collects the elements of a channel according to a matching key (whose position is specified with the <code>by</code> argument).</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb100-1"><a href="advanced-features.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="bu">Channel</span><span class="op">.</span><span class="fu">of</span><span class="op">(</span></span>
<span id="cb100-2"><a href="advanced-features.html#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="op">[</span><span class="st">&quot;key1&quot;</span><span class="op">,</span> <span class="dv">1</span><span class="op">],</span></span>
<span id="cb100-3"><a href="advanced-features.html#cb100-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">[</span><span class="st">&quot;key2&quot;</span><span class="op">,</span> <span class="dv">2</span><span class="op">],</span></span>
<span id="cb100-4"><a href="advanced-features.html#cb100-4" aria-hidden="true" tabindex="-1"></a>  <span class="op">[</span><span class="st">&quot;key1&quot;</span><span class="op">,</span> <span class="dv">3</span><span class="op">],</span></span>
<span id="cb100-5"><a href="advanced-features.html#cb100-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">[</span><span class="st">&quot;key2&quot;</span><span class="op">,</span> <span class="dv">4</span><span class="op">],</span></span>
<span id="cb100-6"><a href="advanced-features.html#cb100-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">[</span><span class="st">&quot;key1&quot;</span><span class="op">,</span> <span class="dv">4</span><span class="op">],</span></span>
<span id="cb100-7"><a href="advanced-features.html#cb100-7" aria-hidden="true" tabindex="-1"></a><span class="op">)</span></span>
<span id="cb100-8"><a href="advanced-features.html#cb100-8" aria-hidden="true" tabindex="-1"></a><span class="op">.</span><span class="fu">groupTuple</span><span class="op">(</span>by<span class="op">:</span> <span class="dv">0</span><span class="op">)</span></span></code></pre></div>
<p>Expected output:</p>
<pre><code>[key1, [1, 3, 4]]
[key2, [2, 4]]</code></pre>
</div>
</div>
<div id="implicit-variables" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Implicit variables<a href="advanced-features.html#implicit-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Implicit variables in Nextflow are a set of variables that are automatically defined by Nextflow for a process, globally, or in <code>nextflow.config</code>.
They can be accessed to modify the execution of processes and workflows according to their value.</p>
<p>Here just a few implicit variables are presented. For a full description visit <a href="https://www.nextflow.io/docs/latest/script.html#implicit-variables">here</a>.</p>
<div id="script-implicit-variables-available-in-main.nf" class="section level3 hasAnchor" number="4.6.1">
<h3><span class="header-section-number">4.6.1</span> Script implicit variables (available in <code>main.nf</code>)<a href="advanced-features.html#script-implicit-variables-available-in-main.nf" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><code>projectDir</code>: the directory where the <code>main.nf</code> script is located</li>
<li><code>launchDir</code>: the directory where Nextflow is executed from</li>
<li><code>params</code>: a dictionary containing parameters given via the command line or via <code>nextflow.config</code> (like <code>params.input</code> that we used in the basic section of this workshop)</li>
<li><code>workDir</code>: the working directory where the processes are executed</li>
</ul>
</div>
<div id="configuration-implicit-variables-available-in-nextflow.config" class="section level3 hasAnchor" number="4.6.2">
<h3><span class="header-section-number">4.6.2</span> Configuration implicit variables (available in <code>nextflow.config</code>)<a href="advanced-features.html#configuration-implicit-variables-available-in-nextflow.config" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><code>launchDir</code>: the directory where Nextflow is executed from</li>
<li><code>projectDir</code>: the directory where the <code>main.nf</code> script is located</li>
</ul>
</div>
<div id="process-implicit-variables-defined-within-a-process" class="section level3 hasAnchor" number="4.6.3">
<h3><span class="header-section-number">4.6.3</span> Process implicit variables (defined within a process)<a href="advanced-features.html#process-implicit-variables-defined-within-a-process" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>All of the process implicit variables are part of the <code>task</code> dictionary.</p>
<ul>
<li><code>task.attempt</code>: the number of times the task has been retried because of errors (when using <code>errorStrategy "retry"</code>)</li>
<li><code>task.hash</code>: the hash values of the task (this is used to define the task’s working directory)</li>
<li><code>task.processes</code>: the name of the process</li>
<li><code>task.name</code>: the name of the task (composed of process name and inputs)</li>
<li><code>task.exitStatus</code>: the exit code of the task</li>
</ul>
</div>
</div>
<div id="directives" class="section level2 hasAnchor" number="4.7">
<h2><span class="header-section-number">4.7</span> Directives<a href="advanced-features.html#directives" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Directives are options that can be applied to processes, affecting their execution in several ways.
We already saw the <code>conda</code>, <code>container</code>, <code>cpu</code>, <code>time</code>, and <code>memory</code> directives in the basic section of this workshop.
Here we will explore them more in detail, together with some additional directives that we did not encounter before.</p>
<p>This list is not exhaustive. For a complete description of Nextflow directives see <a href="https://www.nextflow.io/docs/latest/process.html#directives">here</a>.</p>
<div id="the-conda-directive" class="section level3 hasAnchor" number="4.7.1">
<h3><span class="header-section-number">4.7.1</span> The <code>conda</code> directive<a href="advanced-features.html#the-conda-directive" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>conda</code> directive is used to define a conda environment where the script block is run.
Even when using the faster <code>mamba</code> solver instead than <code>conda</code>, still the <code>conda</code> directive is used to specify the dependencies.</p>
<pre><code>process {
  conda &quot;python pandas&quot;

  script:
    &quot;&quot;&quot;
    &quot;&quot;&quot;
}</code></pre>
</div>
<div id="the-container-directive" class="section level3 hasAnchor" number="4.7.2">
<h3><span class="header-section-number">4.7.2</span> The <code>container</code> directive<a href="advanced-features.html#the-container-directive" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>container</code> directive defines the container used to run the script block.
This can be a Docker container, a Singularity container, or other kinds of containers (see <a href="https://www.nextflow.io/docs/latest/container.html">here</a> for more).
The container runtime to be used is usually defined in the <code>nextflow.config</code> file.
The container can be local or hosted in a container registry like DockerHub.</p>
<pre><code>process {
  container &quot;docker://saulpierottiebi/nvtop&quot;

  script:
    &quot;&quot;&quot;
    &quot;&quot;&quot;
}</code></pre>
</div>
<div id="the-cpus-memory-and-time-directives" class="section level3 hasAnchor" number="4.7.3">
<h3><span class="header-section-number">4.7.3</span> The <code>cpus</code>, <code>memory</code>, and <code>time</code> directives<a href="advanced-features.html#the-cpus-memory-and-time-directives" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>cpus</code>, <code>memory</code>, and <code>time</code> directives are used to define the resources required by a process.
These are used for example when scheduling jobs with a batch scheduler in a cluster environment.
They are able to understand both strings (like <code>"1 GB"</code>, or <code>"2 days"</code>) and also values in the form <code>1.GB</code> or <code>1.day</code>.
The latter expression can also be used in closures to dynamically compute resource requirements (for example, <code>memory { 2.GB * task.attempt }</code>, we will see this better when talking of the <code>errorStrategy</code> directive).</p>
<pre><code>process {
  cpus 4
  memory &quot;1 GB&quot;
  time &quot;2 days&quot;

  script:
    &quot;&quot;&quot;
    &quot;&quot;&quot;
}</code></pre>
</div>
<div id="the-label-directive" class="section level3 hasAnchor" number="4.7.4">
<h3><span class="header-section-number">4.7.4</span> The <code>label</code> directive<a href="advanced-features.html#the-label-directive" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>label</code> directive is used to apply a common set of configurations to a set of processes.
This allows all the configurations to be defined centrally in <code>nextflow.config</code>, instead of being hard-coded in each process definition.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb105-1"><a href="advanced-features.html#cb105-1" aria-hidden="true" tabindex="-1"></a>process do_something <span class="op">{</span></span>
<span id="cb105-2"><a href="advanced-features.html#cb105-2" aria-hidden="true" tabindex="-1"></a>  label <span class="st">&quot;process_long&quot;</span></span>
<span id="cb105-3"><a href="advanced-features.html#cb105-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-4"><a href="advanced-features.html#cb105-4" aria-hidden="true" tabindex="-1"></a>  script<span class="op">:</span></span>
<span id="cb105-5"><a href="advanced-features.html#cb105-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb105-6"><a href="advanced-features.html#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;&quot;&quot;</span></span>
<span id="cb105-7"><a href="advanced-features.html#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb105-8"><a href="advanced-features.html#cb105-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-9"><a href="advanced-features.html#cb105-9" aria-hidden="true" tabindex="-1"></a>process do_something_else <span class="op">{</span></span>
<span id="cb105-10"><a href="advanced-features.html#cb105-10" aria-hidden="true" tabindex="-1"></a>  label <span class="st">&quot;process_long&quot;</span></span>
<span id="cb105-11"><a href="advanced-features.html#cb105-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-12"><a href="advanced-features.html#cb105-12" aria-hidden="true" tabindex="-1"></a>  script<span class="op">:</span></span>
<span id="cb105-13"><a href="advanced-features.html#cb105-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb105-14"><a href="advanced-features.html#cb105-14" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;&quot;&quot;</span></span>
<span id="cb105-15"><a href="advanced-features.html#cb105-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Any process directive can be included in the <code>withLabel</code> code block in <code>nextflow.config</code>.</p>
<p>And in <code>nextflow.config</code>:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb106-1"><a href="advanced-features.html#cb106-1" aria-hidden="true" tabindex="-1"></a>withLabel<span class="op">:</span>process_long <span class="op">{</span></span>
<span id="cb106-2"><a href="advanced-features.html#cb106-2" aria-hidden="true" tabindex="-1"></a>  time <span class="op">=</span> <span class="st">&quot;3 days&quot;</span></span>
<span id="cb106-3"><a href="advanced-features.html#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<div id="the-debug-directive" class="section level3 hasAnchor" number="4.7.5">
<h3><span class="header-section-number">4.7.5</span> The <code>debug</code> directive<a href="advanced-features.html#the-debug-directive" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>debug</code> directive can be set to the boolean values <code>true</code> or <code>false</code>.
If set to <code>true</code>, the standard output of the process is shown on the command line during workflow execution.
As the name suggests, this is useful for debugging particular processes.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb107-1"><a href="advanced-features.html#cb107-1" aria-hidden="true" tabindex="-1"></a>process do_something <span class="op">{</span></span>
<span id="cb107-2"><a href="advanced-features.html#cb107-2" aria-hidden="true" tabindex="-1"></a>  debug <span class="kw">true</span></span>
<span id="cb107-3"><a href="advanced-features.html#cb107-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-4"><a href="advanced-features.html#cb107-4" aria-hidden="true" tabindex="-1"></a>  script<span class="op">:</span></span>
<span id="cb107-5"><a href="advanced-features.html#cb107-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb107-6"><a href="advanced-features.html#cb107-6" aria-hidden="true" tabindex="-1"></a><span class="st">    echo &quot;This will be seen in the console&quot;</span></span>
<span id="cb107-7"><a href="advanced-features.html#cb107-7" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;&quot;&quot;</span></span>
<span id="cb107-8"><a href="advanced-features.html#cb107-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<div id="the-cache-directive" class="section level3 hasAnchor" number="4.7.6">
<h3><span class="header-section-number">4.7.6</span> The <code>cache</code> directive<a href="advanced-features.html#the-cache-directive" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>cache</code> directive controls the behaviour of the Nextflow resume system.
If <code>cache</code> is set to <code>false</code>, the process is not cached and it is executed <em>de novo</em> each time, even if <code>resume</code> is set to <code>true</code> globally.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb108-1"><a href="advanced-features.html#cb108-1" aria-hidden="true" tabindex="-1"></a>process do_something <span class="op">{</span></span>
<span id="cb108-2"><a href="advanced-features.html#cb108-2" aria-hidden="true" tabindex="-1"></a>  cache <span class="kw">false</span></span>
<span id="cb108-3"><a href="advanced-features.html#cb108-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-4"><a href="advanced-features.html#cb108-4" aria-hidden="true" tabindex="-1"></a>  script<span class="op">:</span></span>
<span id="cb108-5"><a href="advanced-features.html#cb108-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb108-6"><a href="advanced-features.html#cb108-6" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;&quot;&quot;</span></span>
<span id="cb108-7"><a href="advanced-features.html#cb108-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<div id="the-errorstrategy-directive" class="section level3 hasAnchor" number="4.7.7">
<h3><span class="header-section-number">4.7.7</span> The <code>errorStrategy</code> directive<a href="advanced-features.html#the-errorstrategy-directive" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>errorStrategy</code> directive controls what happens when the exit code of a process is not <code>0</code> (when the process terminates with an error).
Possible values are “terminate”, “retry”, “finish”, and “ignore”.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb109-1"><a href="advanced-features.html#cb109-1" aria-hidden="true" tabindex="-1"></a>process do_something <span class="op">{</span></span>
<span id="cb109-2"><a href="advanced-features.html#cb109-2" aria-hidden="true" tabindex="-1"></a>  errorStrategy <span class="st">&quot;ignore&quot;</span></span>
<span id="cb109-3"><a href="advanced-features.html#cb109-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-4"><a href="advanced-features.html#cb109-4" aria-hidden="true" tabindex="-1"></a>  script<span class="op">:</span></span>
<span id="cb109-5"><a href="advanced-features.html#cb109-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb109-6"><a href="advanced-features.html#cb109-6" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;&quot;&quot;</span></span>
<span id="cb109-7"><a href="advanced-features.html#cb109-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>It is also possible to use a closure as an argument for the <code>errorStrategy</code> directive.
This allows us to obtain a different exit behaviour with different exit codes.
Combining the “retry” <code>errorStrategy</code> with dynamic resource allocation we can obtain a process that when fails with certain exit codes (for example corresponding to insufficient memory) is retried with more resources.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb110-1"><a href="advanced-features.html#cb110-1" aria-hidden="true" tabindex="-1"></a>process do_something <span class="op">{</span></span>
<span id="cb110-2"><a href="advanced-features.html#cb110-2" aria-hidden="true" tabindex="-1"></a>  errorStrategy <span class="op">{</span> task<span class="op">.</span>exitStatus <span class="op">==</span> <span class="dv">130</span> <span class="op">?</span> <span class="st">&quot;retry&quot;</span> <span class="op">:</span> <span class="st">&quot;terminate&quot;</span> <span class="op">}</span></span>
<span id="cb110-3"><a href="advanced-features.html#cb110-3" aria-hidden="true" tabindex="-1"></a>  memory <span class="op">{</span> <span class="fl">10.G</span>B <span class="op">*</span> task<span class="op">.</span>attempt <span class="op">}</span></span>
<span id="cb110-4"><a href="advanced-features.html#cb110-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-5"><a href="advanced-features.html#cb110-5" aria-hidden="true" tabindex="-1"></a>  script<span class="op">:</span></span>
<span id="cb110-6"><a href="advanced-features.html#cb110-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb110-7"><a href="advanced-features.html#cb110-7" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;&quot;&quot;</span></span>
<span id="cb110-8"><a href="advanced-features.html#cb110-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Note that the exit codes are platform-dependent so are best defined on a platform-dependent basis instead of being hard-coded.</p>
</div>
<div id="the-publishdir-directive" class="section level3 hasAnchor" number="4.7.8">
<h3><span class="header-section-number">4.7.8</span> The <code>publishDir</code> directive<a href="advanced-features.html#the-publishdir-directive" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>publishDir</code> directive defines where to copy the outputs of a process following successful execution.
This is typically used with the final outputs of a workflow that are of interest for further analysis.
Using the <code>publishDir</code> directory, we can obtain all our outputs in an organised directory structure.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb111-1"><a href="advanced-features.html#cb111-1" aria-hidden="true" tabindex="-1"></a>process do_something <span class="op">{</span></span>
<span id="cb111-2"><a href="advanced-features.html#cb111-2" aria-hidden="true" tabindex="-1"></a>  publishDir <span class="st">&quot;/my/output/dir&quot;</span></span>
<span id="cb111-3"><a href="advanced-features.html#cb111-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-4"><a href="advanced-features.html#cb111-4" aria-hidden="true" tabindex="-1"></a>  output<span class="op">:</span></span>
<span id="cb111-5"><a href="advanced-features.html#cb111-5" aria-hidden="true" tabindex="-1"></a>    path <span class="st">&quot;my_file.txt&quot;</span></span>
<span id="cb111-6"><a href="advanced-features.html#cb111-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-7"><a href="advanced-features.html#cb111-7" aria-hidden="true" tabindex="-1"></a>  script<span class="op">:</span></span>
<span id="cb111-8"><a href="advanced-features.html#cb111-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb111-9"><a href="advanced-features.html#cb111-9" aria-hidden="true" tabindex="-1"></a><span class="st">    touch my_file.txt</span></span>
<span id="cb111-10"><a href="advanced-features.html#cb111-10" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;&quot;&quot;</span></span>
<span id="cb111-11"><a href="advanced-features.html#cb111-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<div id="the-executor-and-queue-directives" class="section level3 hasAnchor" number="4.7.9">
<h3><span class="header-section-number">4.7.9</span> The <code>executor</code> and <code>queue</code> directives<a href="advanced-features.html#the-executor-and-queue-directives" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>executor</code> directive allows specifying the executor that should be used for the execution of each process.
This can be “local” (the default) for local execution, “lsf” for using the batch scheduler <a href="https://www.ibm.com/docs/en/spectrum-lsf">IBM Spectrum LSF</a>, or other values for several other batch schedulers.
It is even possible to use cloud infrastructures such as <a href="https://aws.amazon.com/?nc2=h_lg">AWS</a>, <a href="https://azure.microsoft.com/en-gb/">Microsoft Azure</a>, or <a href="https://cloud.google.com/">Google Cloud</a>.</p>
<p>Using executors other than the “local” executor is essential for real-world workflows, where the computational resources required often vastly exceed those of a single laptop or even server.</p>
<p>You can read more about different executors for Nextflow <a href="https://www.nextflow.io/docs/latest/executor.html#">here</a>.</p>
<p>The <code>queue</code> directive allows you to define which of the batch scheduler queues to submit the process’ tasks to.
The value assigned to the <code>queue</code> directive should be a string matching the name of an existing queue.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb112-1"><a href="advanced-features.html#cb112-1" aria-hidden="true" tabindex="-1"></a>process do_something <span class="op">{</span></span>
<span id="cb112-2"><a href="advanced-features.html#cb112-2" aria-hidden="true" tabindex="-1"></a>  executor <span class="st">&quot;lsf&quot;</span></span>
<span id="cb112-3"><a href="advanced-features.html#cb112-3" aria-hidden="true" tabindex="-1"></a>  queue <span class="st">&quot;research&quot;</span></span>
<span id="cb112-4"><a href="advanced-features.html#cb112-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-5"><a href="advanced-features.html#cb112-5" aria-hidden="true" tabindex="-1"></a>  script<span class="op">:</span></span>
<span id="cb112-6"><a href="advanced-features.html#cb112-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb112-7"><a href="advanced-features.html#cb112-7" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;&quot;&quot;</span></span>
<span id="cb112-8"><a href="advanced-features.html#cb112-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<div id="the-ext-directive" class="section level3 hasAnchor" number="4.7.10">
<h3><span class="header-section-number">4.7.10</span> The <code>ext</code> directive<a href="advanced-features.html#the-ext-directive" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>ext</code> directive is used for advanced, custom configurations.
It allows you to define any key-value pair for the process.
The argument of the <code>ext</code> directive should be a closure assigning a variable.
The custom variables are made available like any other <code>task</code> implicit variable in the dictionary <code>task.ext</code>.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb113-1"><a href="advanced-features.html#cb113-1" aria-hidden="true" tabindex="-1"></a>process do_something <span class="op">{</span></span>
<span id="cb113-2"><a href="advanced-features.html#cb113-2" aria-hidden="true" tabindex="-1"></a>  ext <span class="op">{</span> my_var <span class="op">=</span> <span class="st">&quot;my_value&quot;</span> <span class="op">}</span></span>
<span id="cb113-3"><a href="advanced-features.html#cb113-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-4"><a href="advanced-features.html#cb113-4" aria-hidden="true" tabindex="-1"></a>  script<span class="op">:</span></span>
<span id="cb113-5"><a href="advanced-features.html#cb113-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb113-6"><a href="advanced-features.html#cb113-6" aria-hidden="true" tabindex="-1"></a><span class="st">    echo </span><span class="ss">$task</span><span class="op">.</span><span class="ss">ext</span><span class="op">.</span><span class="ss">my_var</span></span>
<span id="cb113-7"><a href="advanced-features.html#cb113-7" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;&quot;&quot;</span></span>
<span id="cb113-8"><a href="advanced-features.html#cb113-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div id="advanced-workflow-configuration" class="section level2 hasAnchor" number="4.8">
<h2><span class="header-section-number">4.8</span> Advanced workflow configuration<a href="advanced-features.html#advanced-workflow-configuration" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We have already explored one of the main locations where Nextflow configurations can be set: the <code>nextflow.config</code> file.
Nextflow actually provides several systems for configuring a workflow, each suited to a specific use case.
We will explore them in this section, together with configuration profiles.</p>
<div id="configuration-files-and-command-line-parameters" class="section level3 hasAnchor" number="4.8.1">
<h3><span class="header-section-number">4.8.1</span> Configuration files and command line parameters<a href="advanced-features.html#configuration-files-and-command-line-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Configuration files can be found in canonical locations, that Nextflow checks automatically.
Alternatively, it is possible to manually load a configuration file in a custom location when running a workflow, or pass configuration parameters on the command line itself.</p>
<p>A rigid hierarchy of configurations is enforced so that in case of conflicting configurations it is predictable which one will be actually used.
The following configuration modes go from highest to lowest priority:</p>
<ul>
<li>Command line parameters (<code>--some_param</code>)</li>
<li>Parameters provided in a file via the <code>-params-file</code> option</li>
<li>Manually sourced configuration files via the <code>-c</code> option</li>
<li>The <code>nextflow.config</code> file in the current directory</li>
<li>The <code>nextflow.config</code> file in the project directory</li>
<li>The <code>$HOME/.nextflow/config</code> file</li>
<li>Values defined in the pipeline script itself (i.e. <code>main.nf</code>)</li>
</ul>
<div id="command-line-parameters" class="section level4 hasAnchor" number="4.8.1.1">
<h4><span class="header-section-number">4.8.1.1</span> Command line parameters<a href="advanced-features.html#command-line-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Any parameter passed on the command line with a double dash (<code>--some_param</code>) is loaded in the <code>params</code> scope in Nextflow (so <code>--some_param 4</code> will assigning a value of 4 to the variable <code>params.some_param</code>).
If a value is specified after the command line flag (for example <code>--some_param 4</code>), the value is assigned to the parameter.
If no value is specified (for example <code>--some_param</code>), the variable will store the boolean value <code>true</code>.
Since command line parameters have the highest priority in the configuration hierarchy, they are often used to override default parameter values set in <code>nextflow.config</code>.</p>
<p>It is important to differentiate workflow command line parameters that are prepended by a double dash <code>--some_param</code> from Nextflow runtime parameters which are prepended by a single dash (<code>-resume</code>).
Nextflow runtime parameters are used to modify the behaviour of Nextflow itself and do not affect the parameter space of the workflow.</p>
</div>
<div id="the-nextflow.config-file" class="section level4 hasAnchor" number="4.8.1.2">
<h4><span class="header-section-number">4.8.1.2</span> The <code>nextflow.config</code> file<a href="advanced-features.html#the-nextflow.config-file" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This file is automatically sourced by Nextflow and should be placed in the same directory as <code>main.nf</code> (another <code>nextflow.config</code> file can also be present in the launch directory, but this is rarely used in my experience).
It is typically used to set workflow-specific configurations that do not depend on the computing environment where the workflow is run, nor on the specific inputs used.</p>
<p>For example, the <code>nextflow.config</code> file can be used to set process software dependencies with a <code>withLabel</code> code block.
Another typical usage is that of setting default values for parameters that can be overridden on the command line (as part of a <code>params</code> block).
Profiles corresponding to different use-case scenarios are also often included.</p>
</div>
<div id="the-home.nextflowconfig-file" class="section level4 hasAnchor" number="4.8.1.3">
<h4><span class="header-section-number">4.8.1.3</span> The <code>$HOME/.nextflow/config</code> file<a href="advanced-features.html#the-home.nextflowconfig-file" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <code>$HOME/.nextflow/config</code> file is typically used for computing environment-specific configurations since it is available to all the workflows run on a given system.</p>
<p>So for example we may want our workflows to behave differently on our local laptop versus on a high-performance cluster.
On my own <code>$HOME/.nextflow/config</code> on the EBI cluster, I define for example when different queues should be used, I set the executor to IBM Spectrum LSF, and I set the path for the input and output directories.</p>
</div>
<div id="custom-configuration-files" class="section level4 hasAnchor" number="4.8.1.4">
<h4><span class="header-section-number">4.8.1.4</span> Custom configuration files<a href="advanced-features.html#custom-configuration-files" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Custom configuration files can be provided via the <code>-c config_file_path</code> option or via the <code>-params-file params_file_path</code> option on the command line.
They have a similar use case to command-line parameters, but they are easier to use when several parameters have to be overridden at once.</p>
</div>
<div id="parameters-hard-coded-in-the-nextflow-script" class="section level4 hasAnchor" number="4.8.1.5">
<h4><span class="header-section-number">4.8.1.5</span> Parameters hard-coded in the Nextflow script<a href="advanced-features.html#parameters-hard-coded-in-the-nextflow-script" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>It is also possible to hard-code parameters in the Nextflow script itself (i.e. in <code>main.nf</code>).
This can be used to achieve more complex configurations with conditional statements.
Note that parameters set in this way have the lowest priority.</p>
</div>
</div>
<div id="configuration-profiles" class="section level3 hasAnchor" number="4.8.2">
<h3><span class="header-section-number">4.8.2</span> Configuration profiles<a href="advanced-features.html#configuration-profiles" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Configuration profiles are sets of configurations that have a collective name and can be optionally activated on the command line.
They can be written in any of the configuration files we explored before.
The following code defines a configuration profile named <code>cluster</code>.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb114-1"><a href="advanced-features.html#cb114-1" aria-hidden="true" tabindex="-1"></a>profiles <span class="op">{</span></span>
<span id="cb114-2"><a href="advanced-features.html#cb114-2" aria-hidden="true" tabindex="-1"></a>  cluster <span class="op">{</span></span>
<span id="cb114-3"><a href="advanced-features.html#cb114-3" aria-hidden="true" tabindex="-1"></a>    executor<span class="op">.</span>name <span class="op">=</span> <span class="st">&quot;lsf&quot;</span></span>
<span id="cb114-4"><a href="advanced-features.html#cb114-4" aria-hidden="true" tabindex="-1"></a>    executor<span class="op">.</span>queueSize <span class="op">=</span> <span class="dv">500</span></span>
<span id="cb114-5"><a href="advanced-features.html#cb114-5" aria-hidden="true" tabindex="-1"></a>    executor<span class="op">.</span>submitRateLimit <span class="op">=</span> <span class="st">&quot;10/1sec&quot;</span></span>
<span id="cb114-6"><a href="advanced-features.html#cb114-6" aria-hidden="true" tabindex="-1"></a>    executor<span class="op">.</span>exitReadTimeout <span class="op">=</span> <span class="st">&quot;30 min&quot;</span></span>
<span id="cb114-7"><a href="advanced-features.html#cb114-7" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb114-8"><a href="advanced-features.html#cb114-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>This profile can be activated by passing the flag <code>-profile cluster</code> on the command line.
Once activated, all the configurations contained in it are applied.
Several profiles can be defined in the <code>profiles</code> block.
If several profiles need to be activated at the same time, this can be done by concatenating them with commas after the <code>-profile</code> option (so if the profiles <code>foo</code> and <code>bar</code> need to be activated at once, I can write <code>-profile foo,bar</code>).</p>
<p>Profiles are particularly useful to set compute environments, software environments (i.e. use Conda versus Docker versus Singularity), and particular running modes (think of a workflow that can perform several things, and the profile is used to choose what the workflow should do).</p>
</div>
</div>
<div id="sub-workflows" class="section level2 hasAnchor" number="4.9">
<h2><span class="header-section-number">4.9</span> Sub-workflows<a href="advanced-features.html#sub-workflows" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Sub-workflows can be used to modularise a workflow in logic steps.
So for example a workflow that does germline variant calling on a set of sequencing files can be composed of a sub-workflow that maps the sequencing files to a reference and a sub-workflow that does the variant calling from the mapped sequencing files.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb115-1"><a href="advanced-features.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>processes defined here<span class="op">&gt;</span></span>
<span id="cb115-2"><a href="advanced-features.html#cb115-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-3"><a href="advanced-features.html#cb115-3" aria-hidden="true" tabindex="-1"></a>workflow MAP_TO_REF <span class="op">{</span></span>
<span id="cb115-4"><a href="advanced-features.html#cb115-4" aria-hidden="true" tabindex="-1"></a>  input<span class="op">:</span></span>
<span id="cb115-5"><a href="advanced-features.html#cb115-5" aria-hidden="true" tabindex="-1"></a>    fastq_ch</span>
<span id="cb115-6"><a href="advanced-features.html#cb115-6" aria-hidden="true" tabindex="-1"></a>  main<span class="op">:</span></span>
<span id="cb115-7"><a href="advanced-features.html#cb115-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">run_bwamem2</span><span class="op">(</span> fastq_ch <span class="op">)</span></span>
<span id="cb115-8"><a href="advanced-features.html#cb115-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mark_duplicates</span><span class="op">(</span> run_bwamem2<span class="op">.</span>out <span class="op">)</span></span>
<span id="cb115-9"><a href="advanced-features.html#cb115-9" aria-hidden="true" tabindex="-1"></a>  output<span class="op">:</span></span>
<span id="cb115-10"><a href="advanced-features.html#cb115-10" aria-hidden="true" tabindex="-1"></a>    mark_duplicates<span class="op">.</span>out</span>
<span id="cb115-11"><a href="advanced-features.html#cb115-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb115-12"><a href="advanced-features.html#cb115-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-13"><a href="advanced-features.html#cb115-13" aria-hidden="true" tabindex="-1"></a>workflow CALL_VARIANTS <span class="op">{</span></span>
<span id="cb115-14"><a href="advanced-features.html#cb115-14" aria-hidden="true" tabindex="-1"></a>  input<span class="op">:</span></span>
<span id="cb115-15"><a href="advanced-features.html#cb115-15" aria-hidden="true" tabindex="-1"></a>    mapped_crams_ch</span>
<span id="cb115-16"><a href="advanced-features.html#cb115-16" aria-hidden="true" tabindex="-1"></a>  main<span class="op">:</span></span>
<span id="cb115-17"><a href="advanced-features.html#cb115-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gatk_haplotypecaller</span><span class="op">(</span> mapped_crams_ch <span class="op">)</span></span>
<span id="cb115-18"><a href="advanced-features.html#cb115-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">genomics_db_import</span><span class="op">(</span> gatk_haplotypecaller<span class="op">.</span>out <span class="op">)</span></span>
<span id="cb115-19"><a href="advanced-features.html#cb115-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gatk_genotypegvcfs</span><span class="op">(</span> genomics_db_import<span class="op">.</span>out <span class="op">)</span></span>
<span id="cb115-20"><a href="advanced-features.html#cb115-20" aria-hidden="true" tabindex="-1"></a>  output<span class="op">:</span></span>
<span id="cb115-21"><a href="advanced-features.html#cb115-21" aria-hidden="true" tabindex="-1"></a>    gatk_genotypegvcfs<span class="op">.</span>out</span>
<span id="cb115-22"><a href="advanced-features.html#cb115-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb115-23"><a href="advanced-features.html#cb115-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-24"><a href="advanced-features.html#cb115-24" aria-hidden="true" tabindex="-1"></a>workflow <span class="op">{</span></span>
<span id="cb115-25"><a href="advanced-features.html#cb115-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">MAP_TO_REF</span><span class="op">(</span> params<span class="op">.</span>input <span class="op">)</span></span>
<span id="cb115-26"><a href="advanced-features.html#cb115-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">CALL_VARIANTS</span><span class="op">(</span> MAP_TO_REF<span class="op">.</span>out <span class="op">)</span></span>
<span id="cb115-27"><a href="advanced-features.html#cb115-27" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Sub-workflows can have an <code>input</code>, a <code>main</code>, and an <code>output</code> block.
The <code>input</code> block defines the name of one or more channels that are passed as inputs to the sub-workflows.
The <code>output</code> block can define a channel accessible from <code>&lt;WORKFLOW_NAME&gt;.out</code> after execution.
The <code>main</code> block defines the actual workflow logic in terms of processes to be run and channel manipulations.</p>
<p>It is also possible to write separate logical steps of the workflow in separate <code>.nf</code> files.
Such additional files can have any name and are usually put under the folder <code>workflows</code> in the project directory.
Workflows defined in such files can be accessed from <code>main.nf</code> using an <code>include</code> statement.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode groovy"><code class="sourceCode groovy"><span id="cb116-1"><a href="advanced-features.html#cb116-1" aria-hidden="true" tabindex="-1"></a>include <span class="op">{</span> PRE_PROCESSING <span class="op">}</span> from <span class="st">&#39;./workflows/pre_processing&#39;</span></span>
<span id="cb116-2"><a href="advanced-features.html#cb116-2" aria-hidden="true" tabindex="-1"></a>include <span class="op">{</span> DO_SOME_WORK <span class="op">}</span> from <span class="st">&#39;./workflows/important_script.nf&#39;</span></span>
<span id="cb116-3"><a href="advanced-features.html#cb116-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-4"><a href="advanced-features.html#cb116-4" aria-hidden="true" tabindex="-1"></a>workflow <span class="op">{</span></span>
<span id="cb116-5"><a href="advanced-features.html#cb116-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">PRE_PROCESSING</span><span class="op">(</span> params<span class="op">.</span>input <span class="op">)</span></span>
<span id="cb116-6"><a href="advanced-features.html#cb116-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">DO_SOME_WORK</span><span class="op">(</span> PRE_PROCESSING<span class="op">.</span>out <span class="op">)</span></span>
<span id="cb116-7"><a href="advanced-features.html#cb116-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<div id="nextflow-tower" class="section level2 hasAnchor" number="4.10">
<h2><span class="header-section-number">4.10</span> Nextflow Tower<a href="advanced-features.html#nextflow-tower" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://cloud.tower.nf/">Nextflow Tower</a> is a centralised web interface that allows the monitoring and submission of Nextflow workflows.
It is possible to use the Nextflow Tower website (for free) or also on-premises solution are available for institutions (at a price).</p>
<p>Nextflow Tower communicates with the execution environment via <a href="https://www.wikiwand.com/en/Secure_Shell">SSH</a> access (if the host is reachable via SSH), or via a <a href="https://help.tower.nf/22.3/agent/">“Tower agent”</a> that is run on the execution environment itself.
Nextflow Tower is particularly useful when you are running several pipelines at the same time in different environments to monitor failures and resource usage.</p>
<p>You can have a look at an example of the Nextflow Tower interface here below.</p>
<p><img src="images/nextflow_tower.png" /></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="basic-challenge.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="advanced-challenge.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "night",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/saulpierotti-ebi/saulpierotti-ebi.github.io/blob/main/source/nextflow_workshop_ebi_predoc_course_2022/03-advanced.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"info": true
});
});
</script>

</body>

</html>
